<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valida tu permiso</title>
<style>
body{font-family:Arial;margin:0;padding:0;background:white;}
h1{text-align:center;font-size:28px;margin-top:40px;font-weight:700;}
p.subtitle{text-align:center;color:#555;margin-top:-10px;margin-bottom:25px;font-size:16px;}
.container{width:90%;max-width:500px;margin:auto;background:#f2f2f2;padding:25px;border-radius:15px;}
label{font-weight:bold;font-size:14px;color:#333;}
input{width:100%;padding:15px;margin:8px 0 18px 0;border-radius:10px;border:1px solid #ccc;font-size:16px;box-sizing:border-box;}
#captchaCanvas{display:block;width:160px;height:50px;margin-bottom:10px;background:#fff;border-radius:4px;}
.buttons{display:flex;}
button{width:50%;padding:15px;border:none;font-size:16px;color:white;cursor:pointer;}
#clearBtn{background:#2ca34f;border-radius:10px 0 0 10px;}
#validateBtn{background:#2ca34f;border-radius:0 10px 10px 0;}
</style>
</head>
<body>
<h1>Valida tu permiso</h1>
<p class="subtitle">Por favor, captura los datos que se encuentran en tu Permiso de Importación</p>
<div class="container">
<label>FOLIO DE PERMISO:</label>
<input type="text" id="folio">
<label>ÚLTIMOS 5 CARACTERES DEL NÚMERO DE SERIE<br>DEL VEHÍCULO O HIN DEL VEHÍCULO:</label>
<input type="text" maxlength="5" id="vin">
<label>ÚLTIMOS 5 CARACTERES DEL NÚMERO DE<br>DOCUMENTO O DEL RFC:</label>
<input type="text" maxlength="5" id="rfc">
<canvas id="captchaCanvas"></canvas>
<input type="text" id="captchaInput">
<div class="buttons">
<button id="clearBtn" type="button">LIMPIAR</button>
<button id="validateBtn" type="button">VALIDAR</button>
</div>
</div>
<script>
const vehicles=[
{folio:"50984679",marca:"TOYOTA",vinFull:"3TMLB5JN1RM011856",modelo:"2024",rfcLast5:"50278"},
{folio:"50387787",marca:"CHEVROLET",vinFull:"1GCPWBEH6MZ117056",modelo:"2021",rfcLast5:"05943"},
{folio:"50497849",marca:"HONDA",vinFull:"5J6RW2H59HL056248",modelo:"2017",rfcLast5:"50278"},
{folio:"50697845",marca:"CHEVROLET",vinFull:"3GCUYEED6MG476841",modelo:"2021",rfcLast5:"05943"}];
let generatedCaptcha="";
function generarCaptcha(){const c=document.getElementById("captchaCanvas");const x=c.getContext("2d");c.width=160;c.height=50;x.clearRect(0,0,160,50);const chars="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789";generatedCaptcha="";for(let i=0;i<6;i++){generatedCaptcha+=chars.charAt(Math.floor(Math.random()*chars.length));}x.font="32px Georgia";x.fillStyle="#000";for(let i=0;i<6;i++){let ang=(Math.random()*0.6)-0.3;x.save();x.translate(20+i*22,32);x.rotate(ang);x.fillText(generatedCaptcha[i],0,0);x.restore();}x.strokeStyle="#000";for(let i=0;i<8;i++){x.beginPath();x.moveTo(Math.random()*160,Math.random()*50);x.lineTo(Math.random()*160,Math.random()*50);x.stroke();}}
function limpiar(){folio.value="";vin.value="";rfc.value="";captchaInput.value="";generarCaptcha();}
function validar(){const fol=folio.value.trim();const v=vin.value.toUpperCase().trim();const r=rfc.value.trim();const cap=captchaInput.value.trim();if(!fol||!v||!r||!cap){alert("Por favor llena todos los campos.");return;}if(cap.toLowerCase()!=generatedCaptcha.toLowerCase()){alert("Captcha incorrecto.");generarCaptcha();return;}const data=vehicles.find(x=>x.folio===fol);if(!data){alert("El folio no existe.");return;}const vinLast5=data.vinFull.slice(-5).toUpperCase();const vinInput=v.replace(/O/g,"0").replace(/I/g,"1");if(vinInput!==vinLast5){alert("Últimos 5 del VIN no coinciden.");return;}if(r!==data.rfcLast5){alert("Últimos 5 del RFC no coinciden.");return;}const url=new URL("verificar.html",location.href);url.searchParams.set("folio",data.folio);url.searchParams.set("marca",data.marca);url.searchParams.set("modelo",data.modelo);url.searchParams.set("vin",data.vinFull);location.href=url;}
clearBtn.onclick=limpiar;
validateBtn.onclick=validar;
window.onload=generarCaptcha;
</script>
</body>
</html>
